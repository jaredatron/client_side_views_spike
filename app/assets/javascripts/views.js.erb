<% views_root = Rails.root.join('app/assets/views') %>
<% Dir[views_root+'**/*'].map(&method(:Pathname)).each do |view| %>
  <%
    next unless view.file?
    view_name, extensions = view.relative_path_from(views_root).to_s.scan(/^(.+?)\.(.+)$/).first
    value = view.read
    # TODO: pre-render views using rubyracer one time on the server
  %>
  ActivePage.Views.register(<%= view_name.to_json %>, Haml(<%= value.to_json %>));
<% end %>


